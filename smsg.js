const [28/12 Ã  09:28] SHADOW+LUMINOð‘ˆð‘†: eyJub2lzZUtleSI6eyJwcml2YXRlIjp7InR5cGUiOiJCdWZmZXIiLCJkYXRhIjoiT0JsaGFqYTB3clpnNklXRkh6MmZRZkhHMGZIM1JVbmZueFhSMjJud1kzWT0ifSwicHVibGljIjp7InR5cGUiOiJCdWZmZXIiLCJkYXRhIjoicGV0UWphKzN1UEM0ZzlSNk1JU3ZOVTJLcVBFRktpOFJ0L0RqVVNLdmgxQT0ifX0sInBhaXJpbmdFcGhlbWVyYWxLZXlQYWlyIjp7InByaXZhdGUiOnsidHlwZSI6IkJ1ZmZlciIsImRhdGEiOiJvRkdNQkIzUnhmVll0VlhRbnVEQ25nZHhMeDMxaW4rUkYzSStwOVFQeGtVPSJ9LCJwdWJsaWMiOnsidHlwZSI6IkJ1ZmZlciIsImRhdGEiOiIyS1d1S3ZrbllxR2hrQlRJSXB5d1lpQ1RoMi9tK3RlQTNwdUxnTzZRR2dVPSJ9fSwic2lnbmVkSWRlbnRpdHlLZXkiOnsicHJpdmF0ZSI6eyJ0eXBlIjoiQnVmZmVyIiwiZGF0YSI6Ik9DTnFTeFAxU1FuOHN4VG5HdTROWVBWV3FBZVJUTXdZclBycHRDUUJsM289In0sInB1YmxpYyI6eyJ0eXBlIjoiQnVmZmVyIiwiZGF0YSI6InJVdm1XZ1M3ZkgzUlpoUGo1QnlPUlNKazJGRlpmMDFnUDYwSTduVnc5UU09In19LCJzaWduZWRQcmVLZXkiOnsia2V5UGFpciI6eyJwcml2YXRlIjp7InR5cGUiOiJCdWZmZXIiLCJkYXRhIjoiQ0czZEYweFFTdStabU55M1YrRFNZaitodU1UNVlMOUp6S0Q3aGZRUnlYST0ifSwicHVibGljIjp7InR5cGUiOiJCdWZmZXIiLCJkYXRhIjoieSszSU13a0ZqS0VmcWpXZDRQUHpTVFpJV2VtaEVSWnpIMUptTm1mL3VFbz0ifX0sInNpZ25hdHVyZSI6eyJ0eXBlIjoiQnVmZmVyIiwiZGF0YSI6InZnQ2FPQmpueFlXeW5nUUtFMTlRMTh2RHkxZkpBazVGcEd3d3dUZmdackhsS201akhxQVhhVnYydXBzMXZmTHJhTlgrbkErbWFTdmlITDBYdGRMY2h3PT0ifSwia2V5SWQiOjF9LCJyZWdpc3RyYXRpb25JZCI6MTg5LCJhZHZTZWNyZXRLZXkiOiJOclZUV3RxamFUcXVDRURIRWgyQkJ0QVc5SWFLYlo2b2dNb0ZjbFpVVWprPSIsInByb2Nlc3NlZEhpc3RvcnlNZXNzYWdlcyI6W10sIm5leHRQcmVLZXlJZCI6MzEsImZpcnN0VW51cGxvYWRlZFByZUtleUlkIjozMSwiYWNjb3VudFN5bmNDb3VudGVyIjowLCJhY2NvdW50U2V0dGluZ3MiOnsidW5hcmNoaXZlQ2hhdHMiOmZhbHNlfSwiZGV2aWNlSWQiOiJsV0JUMk9ST1RlR1RTeDViUDZhb0xRIiwicGhvbmVJZCI6ImVmOTA2NDI0LTY2ODAtNGU4ZC05Y2NhLTg2OTQ2NjhmM2ZiZiIsImlkZW50aXR5SWQiOnsidHlwZSI6IkJ1ZmZlciIsImRhdGEiOiJmbG44eG1nRlpQa2ZaT1ArSE5jeklSbHNINmM9In0sInJlZ2lzdGVyZWQiOnRydWUsImJhY2t1cFRva2VuIjp7InR5cGUiOiJCdWZmZXIiLCJkYXRhIjoiQnhoNURvQ2tXZHp6ZVJWaGs1VXpFMUtoamFjPSJ9LCJyZWdpc3RyYXRpb24iOnt9LCJwYWlyaW5nQ29kZSI6IkZORlRDSDQ2IiwibWUiOnsiaWQiOiIyNDEwNjQzODA3ODoyMUBzLndoYXRzYXBwLm5ldCIsIm5hbWUiOiJTSEFET1crTFVNSU5P8J2RiPCdkYYifSwiYWNjb3VudCI6eyJkZXRhaWxzIjoiQ0kzZ2hPZ0dFSmp0dnJzR0dBTWdBQ2dBIiwiYWNjb3VudFNpZ25hdHVyZUtleSI6IkVMdjM5UlMydFU5dUdyRU1HM3hQYlBIVTEwYVc4R250akwzQVNTaFdUbUk9IiwiYWNjb3VudFNpZ25hdHVyZSI6IjQrdXgyekpoZ3ZyWHJKS3AxYXQyaXJzSGkzUGlWOW9aMCs0Skhqak51dHZsdXRYb1hsT05uMDhYd2JsV1lZYmRkVW42WWtiZFFmYnZSVm5tRzF4ZERnPT0iLCJkZXZpY2VTaWduYXR1cmUiOiJtTlEwNTFGNCtQcHVpWUxKYzUrN0xSQkd2K3g0clcyalNSZkdIcEhRNFpZWEFESklVK1YzK3BCMk5PQWdQVWVFcy9aVjlJNU43UElGaFVNMzV5UEJqQT09In0sInNpZ25hbElkZW50aXRpZXMiOlt7ImlkZW50aWZpZXIiOnsibmFtZSI6IjI0MTA2NDM4MDc4OjIxQHMud2hhdHNhcHAubmV0IiwiZGV2aWNlSWQiOjB9LCJpZGVudGlmaWVyS2V5Ijp7InR5cGUiOiJCdWZmZXIiLCJkYXRhIjoiQlJDNzkvVVV0clZQYmhxeERCdDhUMnp4MU5kR2x2QnA3WXk5d0Vrb1ZrNWkifX1dLCJwbGF0Zm9ybSI6InNtYmEiLCJsYXN0QWNjb3VudFN5bmNUaW1lc3RhbXAiOjE3MzUzNzQ1MDN9
[28/12 Ã  09:29] SHADOW+LUMINOð‘ˆð‘†: 
*[ â€¢  SILENT-SOBX-MD - STARTEDâ€Ž â€¢ ]*
*â•­â”ˆâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â€¢*
*â”‚  â—¦* *_Congratulations Your Bot Active Successfully_*
*â”‚  â—¦*
*â”‚  â—¦* *â á´Šá´ÉªÉ´ á´á´œÊ€ á´¡Êœá´€á´›sá´€á´˜á´˜ á´„Êœá´€É´É´á´‡ÊŸ â*
*â”‚  â—¦*
*â”‚  â—¦* *https://whatsapp.com/channel/0029VaHO5B0G3R3cWkZN970s*
*â”‚  â—¦*
*â”‚  â—¦* *â á´Šá´ÉªÉ´ á´á´œÊ€ Êá´á´œá´›á´œÊ™á´‡ á´„Êœá´€É´É´á´‡ÊŸ â*
*â”‚  â—¦*
*â”‚  â—¦* *https://youtube.com/@silentlover432?si=n3pYYLvSFLP7Shj7*
*â•°â”ˆâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â€¢*
*[ â€¢  B O T  - R E P O â€Ž â€¢ ]*
*â•­â”ˆâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â€¢*
*â”‚âœ«âž  - ðŸŒURL:* *https://github.com/SILENTLOVER40/SILENT-SOBX-MD*
*â•°â”ˆâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â€¢*
*YOUR BOT ACTIVE NOW ENJOYâ™¥ï¸ðŸª„*

*PREFIX: [.]*

*â€¢â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â€¢âŸ¢*
> Â© á´˜á´á´¡á´‡Ê€á´‡á´… Ê™Ê sÉªÊŸá´‡É´á´›ÊŸá´á´ á´‡Ê€â´Â³Â²
*â€¢â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â€¢âŸ¢*

  default: keithConnect,
  useMultiFileAuthState,
  DisconnectReason,
  fetchLatestBaileysVersion,
  makeInMemoryStore,
  downloadContentFromMessage,
  jidDecode,
  proto,
  getContentType
} = require("@whiskeysockets/baileys");

function smsg(keithInstance, message, store) {
  if (!message) {
    return message;
  }

  let messageInfo = proto.WebMessageInfo;

  // Initialize message properties
  if (message.key) {
    message.id = message.key.id;
    message.isBaileys = message.id.startsWith("BAE5") && message.id.length === 16;
    message.chat = message.key.remoteJid;
    message.fromMe = message.key.fromMe;
    message.isGroup = message.chat.endsWith("@g.us");
    message.sender = keithInstance.decodeJid(
      message.fromMe && keithInstance.user.id || message.participant || message.key.participant || message.chat || ''
    );
    
    if (message.isGroup) {
      message.participant = keithInstance.decodeJid(message.key.participant) || '';
    }
  }

  // Process the message content
  if (message.message) {
    message.mtype = getContentType(message.message);

    // Handle specific types of messages (e.g., viewOnce)
    message.msg = message.mtype === "viewOnceMessage" 
      ? message.message[message.mtype] ? message.message[message.mtype].message[getContentType(message.message[message.mtype].message)] : undefined
      : message.message[message.mtype];
    
    // Extract body from different message types
    message.body = message.message.conversation ||
                   (message.msg && message.msg.caption) ||
                   (message.msg && message.msg.text) ||
                   (message.mtype === "listResponseMessage" && message.msg && message.msg.singleSelectReply && message.msg.singleSelectReply.selectedRowId) ||
                   (message.mtype === "buttonsResponseMessage" && message.msg && message.msg.selectedButtonId) ||
                   (message.mtype === "viewOnceMessage" && message.msg && message.msg.caption) ||
                   message.text;

    let quotedMessage = message.quoted = message.msg.contextInfo ? message.msg.contextInfo.quotedMessage : null;
    message.mentionedJid = message.msg.contextInfo ? message.msg.contextInfo.mentionedJid : [];

    // Handle quoted messages
    if (quotedMessage) {
      let contentType = getContentType(quotedMessage);
      message.quoted = quotedMessage[contentType];

      if (["productMessage"].includes(contentType)) {
        contentType = getContentType(message.quoted);
        message.quoted = message.quoted[contentType];
      }

      if (typeof message.quoted === "string") {
        message.quoted = { 'text': message.quoted };
      }

      message.quoted.mtype = contentType;
      message.quoted.id = message.msg.contextInfo.stanzaId;
      message.quoted.chat = message.msg.contextInfo.remoteJid || message.chat;
      message.quoted.isBaileys = message.quoted.id ? message.quoted.id.startsWith("BAE5") && message.quoted.id.length === 16 : false;
      message.quoted.sender = keithInstance.decodeJid(message.msg.contextInfo.participant);
      message.quoted.fromMe = message.quoted.sender === keithInstance.decodeJid(keithInstance.user.id);
      message.quoted.text = message.quoted.text || message.quoted.caption || message.quoted.conversation || message.quoted.contentText || message.quoted.selectedDisplayText || message.quoted.title || '';
      message.quoted.mentionedJid = message.msg.contextInfo ? message.msg.contextInfo.mentionedJid : [];

      // Helper function to fetch quoted message
      message.quoted.getQuotedObj = message.quoted.getQuotedMessage = async () => {
        if (!message.quoted.id) {
          return false;
        }
        let quotedMsg = await store.loadMessage(message.chat, message.quoted.id, keithInstance);
        return exports.smsg(keithInstance, quotedMsg, store);
      };

      let quotedMessageFakeObj = message.quoted.fakeObj = messageInfo.fromObject({
        'key': {
          'remoteJid': message.quoted.chat,
          'fromMe': message.quoted.fromMe,
          'id': message.quoted.id
        },
        'message': quotedMessage,
        ...message.isGroup ? { 'participant': message.quoted.sender } : {}
      });

      // Helper functions for deleting and forwarding quoted messages
      message.quoted["delete"] = () => keithInstance.sendMessage(message.quoted.chat, { 'delete': quotedMessageFakeObj.key });
      message.quoted.copyNForward = (toChat, forceForward = false, options = {}) => keithInstance.copyNForward(toChat, quotedMessageFakeObj, forceForward, options);
      message.quoted.download = () => keithInstance.downloadMediaMessage(message.quoted);
    }
  }

  // Handle URL in the message
  if (message.msg.url) {
    message.download = () => keithInstance.downloadMediaMessage(message.msg);
  }

  // Extract main text content from the message
  message.text = message.msg.text || message.msg.caption || message.message.conversation || message.msg.contentText || message.msg.selectedDisplayText || message.msg.title || '';

  // Reply function
  message.reply = (replyText, replyTo = message.chat, options = {}) => {
    if (Buffer.isBuffer(replyText)) {
      return keithInstance.sendMedia(replyTo, replyText, "file", '', message, { ...options });
    }
    return keithInstance.sendText(replyTo, replyText, message, { ...options });
  };

  // Function to copy the message
  message.copy = () => exports.smsg(keithInstance, messageInfo.fromObject(messageInfo.toObject(message)));

  // Function to forward the message
  message.copyNForward = (toChat = message.chat, forceForward = false, options = {}) => keithInstance.copyNForward(toChat, message, forceForward, options);

  return message;
}

module.exports = {
  smsg
};
